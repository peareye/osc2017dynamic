# Override from parent directory, everything in this directory is web accessible
Allow from all

# Prevent direct directory access, however
Options -Indexes

# Hide sitemap.xml in search results
<Files sitemap.xml>
  Header set X-Robots-Tag "noindex"
</Files>

RewriteEngine On

# Rewrite old routes to new routes
RewriteCond %{HTTP_HOST} !^localhost$ [NC]
RewriteRule (.*)$/main/property/OurSandCastle/Home $1 [R=301,NC,L]
RewriteRule (.*)$/main/property/OurSandCastle/Rates-and-Policies $1/rates [R=301,NC,L]
RewriteRule (.*)$/main/property/OurSandCastle/Reservation-Request $1/reserve [R=301,NC,L]
RewriteRule (.*)$/main/property/OurSandCastle/Picture-Gallery $1/gallery [R=301,NC,L]
RewriteRule (.*)$/main/property/OurSandCastle/Calendar $1/calendar [R=301,NC,L]
RewriteRule (.*)$/main/property/OurSandCastle/Contact-Us $1/contact [R=301,NC,L]

# Final check to see if the user is attempting to access a valid file,
# such as an image or css document, if this isn't true this sends the
# request to index.php.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !\.(jpe?g|png|gif)$ [NC]
RewriteRule . index.php [L]

# Caching
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 seconds"
    ExpiresByType image/x-icon "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    #ExpiresByType text/css "access plus 60 minutes"
    #ExpiresByType text/javascript "access plus 60 minutes"
    #ExpiresByType application/x-javascript "access plus 60 minutes"
    #ExpiresByType text/html "access plus 60 seconds"
</IfModule>

<ifModule mod_headers.c>
  <filesMatch "\.(ico|jpe?g|png|gif)$">
    Header set Cache-Control "public"
  </filesMatch>
  <filesMatch "\.(css|woff)$">
    Header set Cache-Control "public"
  </filesMatch>
  <filesMatch "\.(js)$">
    Header set Cache-Control "private"
  </filesMatch>
</ifModule>
